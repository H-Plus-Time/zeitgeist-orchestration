box: google/cloud-sdk
deploy:
  steps:
    - bigtruedata/gcloud-auth-service-account:
        key: $GCP_SERVICE_ACCOUNT_JSON
    - script:
        name: install yarn, git
        code: |
          apt-get update && apt-get install -y git
    - script:
        name: instantiate pyspark cluster, teardown
        code: |
          sh ./bootstrap.sh && sh ./delete-cluster.sh
    - script:
        name: populate data
        code: |
          sh ./populate_titan.sh
